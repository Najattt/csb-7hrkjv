(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{101:function(e,s,t){"use strict";t.r(s);var a=t(1),n=t.n(a),c=t(18),r=t.n(c),i=(t(48),t(49),t(4)),o=(t(42),t(0));t(54);var l=function(e){const[s,t]=Object(a.useState)({password:"",userId:""}),n=e=>{t({...s,[e.target.name]:e.target.value})};return Object(o.jsx)("div",{className:"login-container",children:Object(o.jsxs)("div",{className:"login-form",children:[Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{className:"form-label",children:"User Id"}),Object(o.jsx)("input",{type:"email",className:"form-control c-sign-in-user-id",name:"userId",onChange:n})]}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{className:"form-label",children:"Password"}),Object(o.jsx)("input",{type:"password",className:"form-control c-sign-in-psw",name:"password",onChange:n})]}),Object(o.jsx)("div",{style:{paddingBottom:"10px",color:"red"},children:Object(o.jsx)("span",{children:e.loginInfo.message})}),Object(o.jsx)("button",{type:"submit",className:"btn btn-primary c-btn-sign-in",onClick:()=>{console.log(s),e.signIn(s)},children:"Login"})]})})};t(55);var d=e=>{const[s,t]=Object(a.useState)({userId:"",password:"",firstName:"",lastName:""}),n=Object(i.d)((e=>e.signUp)),c=e=>{t({...s,[e.target.name]:e.target.value})};return Object(o.jsxs)("div",{className:"signup-container",children:[console.log("signUpData",n),Object(o.jsxs)("div",{className:"signup-form",children:[Object(o.jsx)("div",{className:n.isError?"c-error":"c-success",children:n.message}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{className:"form-label",children:"User Id"}),Object(o.jsx)("input",{type:"email",className:"form-control",name:"userId",onChange:c})]}),Object(o.jsxs)("div",{className:"mb-3",children:[Object(o.jsx)("label",{className:"form-label",children:"Password"}),Object(o.jsx)("input",{type:"password",className:"form-control",name:"password",onChange:c})]}),Object(o.jsx)("div",{className:"mb-3",style:{display:"table"},children:Object(o.jsxs)("div",{style:{display:"table-row"},children:[Object(o.jsxs)("div",{style:{display:" table-cell"},children:[Object(o.jsx)("label",{className:"form-label",children:"First Name"}),Object(o.jsx)("input",{type:"email",className:"form-control",name:"firstName",onChange:c})]}),Object(o.jsxs)("div",{style:{display:" table-cell"},children:[Object(o.jsx)("label",{className:"form-label",children:"Last Name"}),Object(o.jsx)("input",{type:"email",className:"form-control",name:"lastName",onChange:c})]})]})}),Object(o.jsx)("div",{}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{type:"submit",className:"btn btn-success",style:{float:"right"},onClick:()=>{e.createAccount(s)},children:"Create Account"})}),Object(o.jsx)("div",{children:Object(o.jsx)("button",{type:"submit",className:"btn btn-info",onClick:()=>{console.log("sign up"),e.gotoLogin()},children:"Go to Login!"})})]})]})};const h={LOGIN_LOADING:"lOGIN_LOADING",LOGIN_SUCCESS:"lOGIN_SUCCESS",LOGIN_FAILED:"LOGIN_FAILED",SIGNUP_LOADING:"SIGNUP_LOADING",SIGNUP_SUCCESS:"SIGNUP_SUCCESS",SIGNUP_FAILED:"SIGNUP_FAILED",FETCH_USERS_LOADING:"FETCH_USERS_LOADING",FETCH_USERS_SUCCESS:"FETCH_USERS_SUCCESS",FETCH_USERS_FAILED:"FETCH_USERS_FAILED",FETCH_CHAT_MSGS_LOADING:"FETCH_CHAT_MSGS_LOADING",FETCH_CHAT_MSGS_SUCCESS:"FETCH_CHAT_MSGS_SUCCESS",FETCH_CHAT_MSGS_FAILED:"FETCH_CHAT_MSGS_FAILED",FETCH_CHATS_LOADING:"FETCH_CHAT_MSGS_LOADING",FETCH_CHATS_SUCCESS:"FETCH_CHAT_MSGS_SUCCESS",FETCH_CHATS_FAILED:"FETCH_CHAT_MSGS_FAILED",MSG_SEND_SUCCESS:"MSG_SEND_SUCCESS",MSG_SEND_FAILED:"MSG_SEND_FAILED",GROUP_MSG_SEND_SUCCESS:"GROUP_MSG_SEND_SUCCESS",GROUP_MSG_SEND_FAILED:"GROUP_MSG_SEND_FAILED",FETCH_GROUP_CHATS_SUCCESS:"FETCH_GROUP_CHATS_SUCCESS",FETCH_GROUP_CHATS_FAILED:"FETCH_GROUP_CHATS_FAILED",CREATE_GROUP_SUCCESS:"CREATE_GROUP_SUCCESS",CREATE_GROUP_FAILED:"CREATE_GROUP_FAILED",RECIVE_GROUP_CHAT_MSG_SUCCESS:"RECIVE_GROUP_CHAT_MSG_SUCCESS",RECIVE_CHAT_MESSAGE_TYPING:"RECIVE_CHAT_MESSAGE_TYPING",CHAT_MESSAGE_TYPING_STOP:"CHAT_MESSAGE_TYPING_STOP"};function g(e){return{type:h.FETCH_CHATS_FAILED,faildMessage:e}}function p(e){return{type:h.MSG_SEND_SUCCESS,response:e}}function u(e){return{type:h.MSG_SEND_FAILED,faildMessage:e}}function j(e){return{type:h.GROUP_MSG_SEND_FAILED,faildMessage:e}}function m(e){return{type:h.FETCH_GROUP_CHATS_FAILED,faildMessage:e}}function S(e){return{type:h.CREATE_GROUP_FAILED,faildMessage:e}}function O(e){return{type:h.RECIVE_CHAT_MESSAGE_TYPING,response:e}}function C(e){return{type:h.LOGIN_FAILED,response:e}}function b(e){return{type:h.SIGNUP_FAILED,response:e}}function E(e){return{type:h.FETCH_USERS_FAILED,faildMessage:e}}const _="http://localhost:5000/api/",f={SIGN_UP:_+"user/signUp",SIGN_IN:_+"user/signIn",FETCH_USERS:_+"user/",SNED_MSG:_+"chat",FETCH_CHAT_MSGS:_+"chat/",FETCH_CHATS:_+"chat/",FETCH_GROUP_CHAT_MSGS:_+"chat/fetchChatRooms/",SNED_GROUP_MSG:_+"chat/sendChatRoomMessage",CREATE_GROUP:_+"chat/createChatRoom",SEND_TYPING_MESSAGE:_+"chat/sendTypingMessage"};function N(e){return s=>(s({type:h.SIGNUP_LOADING}),fetch(f.SIGN_UP,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log(e),e&&0===e.statusCode?s(function(e){return{type:h.SIGNUP_SUCCESS,response:e}}(e)):s(b(e))})).catch((e=>{console.log(e),s(b("Signup failed."))})))}function I(e){return s=>(s({type:h.LOGIN_LOADING}),fetch(f.SIGN_IN,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log(e),e&&0===e.statusCode?s(function(e){return{type:h.LOGIN_SUCCESS,response:e}}(e.result[0])):s(C(e))})).catch((e=>{console.log(e),s(C("Login failed"))})))}function U(){return e=>(e({type:h.FETCH_USERS_LOADING}),fetch(f.FETCH_USERS,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((s=>{console.log(s),s&&0===s.statusCode?e(function(e){return{type:h.FETCH_USERS_SUCCESS,response:e}}(s.result)):e(E(s.description))})).catch((s=>{console.log(s),e(E("Fetch Users failed"))})))}function x(e){return s=>(s({type:h.FETCH_CHATS_LOADING}),fetch(f.FETCH_CHATS+e,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((e=>{console.log(e),e&&0===e.statusCode?s(function(e){return{type:h.FETCH_CHATS_SUCCESS,response:e}}(e.result)):s(g(e.description))})).catch((e=>{console.log(e),s(g("Fetch Chats failed"))})))}function v(e){return s=>fetch(f.FETCH_GROUP_CHAT_MSGS+e,{headers:{"Content-Type":"application/json"},method:"GET"}).then((e=>e.json())).then((e=>{console.log(e),e&&0===e.statusCode?s(function(e){return{type:h.FETCH_GROUP_CHATS_SUCCESS,response:e}}(e.result)):s(m(e.description))})).catch((e=>{console.log(e),s(m("Fetch Group Messages failed"))}))}function T(e){return s=>fetch(f.SNED_GROUP_MSG,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log(e),e&&0===e.statusCode?s(function(e){return{type:h.GROUP_MSG_SEND_SUCCESS,response:e}}(e.result[0])):s(j(e.description))})).catch((e=>{console.log(e),s(j("Group message failed"))}))}function G(e){return s=>fetch(f.CREATE_GROUP,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log(e),e&&0===e.statusCode?s(function(e){return{type:h.CREATE_GROUP_SUCCESS,response:e}}(e.result[0])):s(S(e.description))})).catch((e=>{console.log(e),s(S("Group creation failed."))}))}t(56);const y={GROUP:"GROUP",USER:"USER",CHAT_USER_TYPING:"CHAT_USER_TYPING",GROUP_CHAT_USER_TYPING:"GROUP_CHAT_USER_TYPING"};t(57),t(58);function A(e){var s=new Date(e),t=new Date,a=(s.getMonth()+1).toString().padStart(2,"0"),n=s.getDate().toString().padStart(2,"0"),c=s.getFullYear().toString().padStart(4,"0"),r="".concat(s.getHours().toString().padStart(2,"0"),":").concat(s.getMinutes().toString().padStart(2,"0"),":").concat(s.getSeconds().toString().padStart(2,"0"));return s.getDay()===t.getDay()?r:s.getDate()===t.getDate()-1?"Yesterday "+r:s.getFullYear()===t.getFullYear()?n+"-"+a+" "+r:n+"-"+a+c+" "+r}function R(e){var s=new Date(e),t=new Date,a=(s.getMonth()+1).toString().padStart(2,"0"),n=s.getDate().toString().padStart(2,"0"),c=s.getFullYear().toString().padStart(4,"0"),r="".concat(s.getHours().toString().padStart(2,"0"),":").concat(s.getMinutes().toString().padStart(2,"0"));return s.getDay()===t.getDay()?r:s.getDate()===t.getDate()-1?"Yesterday":s.getFullYear()===t.getFullYear()?n+"-"+a:n+"-"+a+c}t(59);var M=e=>{const{name:s,typing:t,showName:n,userNameClass:c,waveClass:r}=e,l=Object(i.c)();return Object(a.useEffect)((()=>{setTimeout((()=>{return l((e=t,{type:h.CHAT_MESSAGE_TYPING_STOP,response:e}));var e}),1e4)})),Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:c,children:n?s+" is typing":" typing"}),Object(o.jsxs)("div",{id:r,children:[Object(o.jsx)("span",{class:"dot"}),Object(o.jsx)("span",{class:"dot"}),Object(o.jsx)("span",{class:"dot"})]})]})};var L=e=>{const{oldChat:s,recipientUser:t,loginInfo:n,chats:c,chatType:r,users:i}=e;console.log(n);const[l,d]=Object(a.useState)(""),h=Object(a.useRef)(null);Object(a.useEffect)((()=>{(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})()}));const g=a=>{a.preventDefault(),console.log(c);var i={};i=r===y.USER?{senderId:n.data.id,recipientId:t.id,content:l,chatId:s.chatId}:{chatRoomId:c.chatRoomId,message:l,senderId:n.data.id},e.sendMessage(i,r),console.log("Message sent successfully",JSON.stringify(i)),d("")},p=e=>{var s=i.data.findIndex((s=>s.id===e));return s>-1?i.data[s]:null},u=(e,s)=>e&&e.senderUserId&&e.senderUserId===n.data.id?((e,s)=>Object(o.jsx)("div",{className:"msg right-msg",children:Object(o.jsxs)("div",{className:"msg-bubble",children:[Object(o.jsx)("div",{className:"msg-info",children:Object(o.jsx)("div",{className:"msg-info-time",children:A(e.messageTimestamp)})}),Object(o.jsx)("div",{className:"msg-text",children:e.message})]})},s))(e,s):((e,s)=>{const t=p(e.senderUserId);return Object(o.jsxs)("div",{className:"msg left-msg",children:[Object(o.jsx)("div",{className:"msg-img",style:{backgroundImage:"url(".concat(t.avatarUrl,")")}}),Object(o.jsxs)("div",{className:"msg-bubble",children:[Object(o.jsxs)("div",{className:"msg-info",children:[Object(o.jsx)("div",{className:"msg-info-name",children:t.firstName}),Object(o.jsx)("div",{className:"msg-info-time",children:A(e.messageTimestamp)})]}),Object(o.jsx)("div",{className:"msg-text",children:e.message})]})]},s)})(e,s);return Object(o.jsx)("div",{className:"chat-message-container",children:Object(o.jsx)("section",{className:"msger",children:r?Object(o.jsxs)("div",{children:[Object(o.jsxs)("header",{className:"msger-header",children:[(e=>{if(e&&e.chatId){const s=p(e.senderUserId===n.data.id?e.reciverUserId:e.senderUserId);return s?Object(o.jsxs)("div",{className:"msger-header-title",children:[s.avatarUrl?Object(o.jsx)("img",{src:s.avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar",style:{float:"left"}}):Object(o.jsx)("span",{className:"chat-user-icon chat-title-user-icon"}),Object(o.jsx)("div",{className:"chat-title-user-name",children:s.firstName+" "+s.lastName}),Object(o.jsx)("i",{className:"fas fa-comment-alt"})]}):null}return e&&e.chatRoomId?Object(o.jsxs)("div",{className:"msger-header-title",children:[e.avatarUrl?Object(o.jsx)("img",{src:e.avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar"}):Object(o.jsx)("span",{className:"chat-user-group-icon chat-title-group-icon"}),Object(o.jsxs)("div",{className:"chat-title-group-name",children:[" ",e.chatRoomName]}),Object(o.jsx)("i",{className:"fas fa-comment-alt",children:" "})]}):t?Object(o.jsxs)("div",{className:"msger-header-title",children:[t.avatarUrl?Object(o.jsx)("img",{src:t.avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar",style:{float:"left"}}):Object(o.jsx)("span",{className:"chat-user-icon chat-title-user-icon"}),Object(o.jsx)("div",{className:"chat-title-user-name",children:t.firstName+" "+t.lastName}),Object(o.jsx)("i",{className:"fas fa-comment-alt"})]}):void 0})(c),Object(o.jsx)("div",{className:"msger-header-options",children:Object(o.jsx)("span",{children:Object(o.jsx)("i",{className:"fas fa-cog"})})})]}),Object(o.jsxs)("main",{className:"msger-chat",id:"msger-chat-id",children:[r===y.USER?Object(o.jsxs)("div",{children:[" ",c&&c.chatMessages&&c.chatMessages.length?c.chatMessages.map(((e,s)=>u(e,s))):"No Messages to load"]}):c&&c.chatMessages&&c.chatMessages.length?c.chatMessages.map(((e,s)=>u(e,s))):"Welcome to group",Object(o.jsx)("div",{ref:h})]}),(e=>{if(e&&e.typing&&e.typing.isTyping){if(e.typing.chatType===y.USER){const s=p(e.senderUserId===n.data.id?e.reciverUserId:e.senderUserId);return s?Object(o.jsx)("div",{children:Object(o.jsx)(M,{name:s.firstName,typing:e.typing,showName:!0,userNameClass:"chat-middle-typing-user-name",waveClass:"wave-middle"})}):Object(o.jsx)("div",{style:{height:"23px"}})}{const s=p(e.typing.senderId);return s?Object(o.jsx)("div",{children:Object(o.jsx)(M,{name:s.firstName,typing:e.typing,showName:!0,userNameClass:"chat-middle-typing-user-name",waveClass:"wave-middle"})}):Object(o.jsx)("div",{style:{height:"23px"}})}}return Object(o.jsx)("div",{style:{height:"23px"}})})(c),Object(o.jsxs)("div",{className:"msger-inputarea",children:[Object(o.jsx)("input",{type:"text",className:"msger-input",placeholder:"Enter your message...",value:l,name:"messageText",onKeyPress:e=>{"Enter"===e.key&&g(e)},onChange:s=>{d(s.target.value);const a=null!==c.chatId&&c.chatId?c.chatId:null!=c.chatRoomId&&c.chatRoomId?c.chatRoomId:null;if(s.target.value.length>=3&&a){const s={id:a,receiverId:t.id,senderId:n.data.id,chatType:r};e.sendTypingNotification(s)}}}),Object(o.jsx)("span",{className:"msger-send-btn",onClick:g})]})]}):Object(o.jsx)("div",{className:"chat-welcome-image",children:Object(o.jsx)("div",{className:"chat-welocme-msg",children:"Welcome to chat room"})})})})};t(60),t(61);var D=e=>{const{index:s,user:t}=e;return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:e.checked?e.chatUserProfile+" chat-user-profile":e.chatUserProfile,onClick:s=>{(s=>{e.handleUser(s)})(t)},children:[t.avatarUrl?Object(o.jsx)("img",{src:t.avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar"}):Object(o.jsx)("span",{className:e.chatUserIcon}),Object(o.jsxs)("div",{className:t.avatarUrl?"chat-user-chat-profile-user-name2":"chat-user-chat-profile-user-name",children:[" ",t.firstName+" "+t.lastName]})]},s)})};var H=e=>{const{loginInfo:s,users:t}=e,a=s=>{console.log(s),e.startChat(s)};return Object(o.jsx)("div",{children:Object(o.jsxs)("div",{className:"",children:[Object(o.jsxs)("div",{className:"chat-right-header",children:[Object(o.jsx)("spnan",{className:"c-all-users",children:"All Users"}),Object(o.jsx)("span",{className:"c-back-chat",onClick:()=>{console.log("clicked closeOpenOption"),e.closeOpenOption()},children:"X"})]}),Object(o.jsx)("div",{children:Object(o.jsx)("input",{className:"chat-user-group-search-input",placeholder:"Search User",type:"text"})}),Object(o.jsx)("div",{className:"users-div",children:t&&t.data&&t.data.length?t.data.map(((e,t)=>e.id===s.data.id?null:Object(o.jsx)(D,{user:e,index:t,handleUser:a,chatUserProfile:"chat-user-chat-profile",chatUserIcon:"chat-user-icon"}))):"No Users Found"})]})})};class F extends n.a.Component{constructor(e){super(e),this.state={selected:!1},this.handleChange=this.handleChange.bind(this)}handleChange(){this.setState((e=>({selected:!e.selected})),(()=>this.props.onOptionChange(this.props.id,this.state.selected)))}render(){return Object(o.jsx)("div",{children:Object(o.jsx)("div",{id:this.props.id,children:Object(o.jsx)(D,{user:this.props.user,index:this.props.id,handleUser:this.handleChange,chatUserProfile:"chat-user-profile-group-create",chatUserIcon:"chat-user-icon",checked:this.state.selected})})})}}var P=F;class w extends n.a.Component{constructor(e){super(e),this.state={selectedOptions:[]},this.onOptionsChange=this.onOptionsChange.bind(this)}onOptionsChange(e,s){s?this.setState((s=>(s.selectedOptions.push(e),{selectedOptions:s.selectedOptions})),(()=>this.props.onOptionsChange(this.state.selectedOptions))):this.setState((s=>{const t=s.selectedOptions.indexOf(e);return t>-1&&s.selectedOptions.splice(t,1),{selectedOptions:s.selectedOptions}}),(()=>this.props.onOptionsChange(this.state.selectedOptions)))}render(){return Object(o.jsxs)("fieldset",{children:[Object(o.jsx)("legend",{children:this.props.title}),this.props.options.map(((e,s)=>Object(o.jsx)(P,{user:e,id:e.id,option:e.firstName,onOptionChange:this.onOptionsChange},e.id)))]})}}var k=w;var Y=e=>{const{users:s,loginInfo:t}=e,[n,c]=Object(a.useState)({groupName:"",groupMembers:[]});return Object(o.jsxs)("div",{className:"create-chat-room-container",children:[Object(o.jsxs)("div",{className:"chat-group-create-btns",children:[Object(o.jsx)("span",{className:"group-create-name",children:"New Chat Group"}),Object(o.jsx)("button",{className:"btn-close-group",onClick:e.backFromCreateGroup,children:"X"})]}),Object(o.jsxs)("div",{className:"group-name-btn-div",children:[Object(o.jsx)("input",{type:"text",className:"group-name-input",name:"groupName",placeholder:"Enter Group Name",onChange:e=>{c({...n,[e.target.name]:e.target.value})}}),Object(o.jsx)("button",{className:"chat-btn btn-create",onClick:()=>{const s={chatRoomName:n.groupName,chatRoomUserIds:n.groupMembers,createdBy:t.data.id};e.submitCreateGroup(s)},children:"Create Group"})]}),Object(o.jsx)("div",{style:{padding:"5px"},children:"Select the participants"}),Object(o.jsx)("div",{children:Object(o.jsx)(k,{options:s.data,onOptionsChange:e=>{console.log(e),c({...n,groupMembers:e}),console.log(n)}})})]})};t(25);var J=e=>{const{chats:s,oldChat:t,recipientUser:n,loginInfo:c,users:r}=e,[l,d]=Object(a.useState)([]),[h,g]=Object(a.useState)(""),p=(s,t)=>{e.openUserChat(s,t)},u=e=>e.reciverUser&&c.data&&e.reciverUser.id===c.data.id?e.senderUser:e.reciverUser;Object(i.d)((e=>e.chats));const j=e=>{if(r.data){var s=r.data.findIndex((s=>s.id===e));return s>-1?r.data[s]:null}return null},m=e=>{if(e&&e.typing&&e.typing.isTyping){let s;return s=e.typing.chatType===y.USER?j(e.senderUserId===c.data.id?e.reciverUserId:e.senderUserId):j(e.typing.senderId),s?Object(o.jsx)("div",{children:Object(o.jsx)(M,{name:s.firstName,typing:e.typing,showName:!1,userNameClass:"chat-left-typing-user-name",waveClass:"wave-left-side"})}):Object(o.jsx)("div",{style:{height:"23px"}})}return Object(o.jsx)("div",{style:{height:"23px"}})};return Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"chat-user-group-search",children:Object(o.jsx)("input",{className:"chat-user-group-search-input",placeholder:"Search Chat",type:"text"})}),Object(o.jsx)("div",{className:"chat-user-chats",id:"jkj12",children:s&&s.data?s.data.map(((e,s)=>e.chatId?((e,s)=>Object(o.jsxs)("div",{id:s,className:"chat-user-chat-profile",onClick:s=>{p(e,y.USER)},children:[u(e).avatarUrl?Object(o.jsx)("img",{src:u(e).avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar"}):Object(o.jsx)("span",{className:"chat-user-icon",style:{marginLeft:"-5px"}}),Object(o.jsxs)("div",{className:u(e).avatarUrl?"chat-user-chat-profile-user-name2":"chat-user-chat-profile-user-name",children:[u(e).firstName," "]},e.chatId),Object(o.jsx)("div",{className:"chat-left-last-timestamp",children:R(e.lastTimestamp)}),e.typing&&e.typing.isTyping?m(e):Object(o.jsx)("div",{className:"chat-left-last-sent",children:j(e.lastMessageSentBy).firstName+": "+e.lastMessage}),Object(o.jsx)("div",{className:"chat-left-msg-count",children:Object(o.jsx)("span",{style:{textAlign:"center",padding:"5px"},children:"5"})})]},s))(e,s):((e,s)=>Object(o.jsxs)("div",{id:s,className:"chat-user-chat-profile",onClick:s=>{p(e,y.GROUP)},children:[e.avatarUrl&&null!==e.avatarUrl?Object(o.jsx)("img",{src:e.avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar"}):Object(o.jsx)("span",{className:"chat-user-group-icon"}),Object(o.jsxs)("div",{className:"chat-user-chat-profile-user-name",children:[" ",e.chatRoomName," "]},e.chatRoomId),Object(o.jsx)("div",{className:"chat-left-last-timestamp",children:R(e.lastTimestamp)}),e.typing&&e.typing.isTyping?m(e):Object(o.jsx)("div",{className:"chat-left-last-sent",children:e.lastMessageSentBy?j(e.lastMessageSentBy).firstName+": "+e.lastMessage:""}),Object(o.jsx)("div",{className:e.lastMessageSentBy?"chat-left-msg-count":"chat-left-msg-count-2",children:"10"})]},s))(e,s))):null})]})};t(62);var V=e=>{const{dropDownList:s}=e;return Object(o.jsx)("div",{className:"chat-dropdown-menu",children:s.map(((s,t)=>Object(o.jsxs)("div",{className:"chat-dropdown-option",onClick:t=>(s=>{e.selectedItem(s)})(s),children:[" ",s," "]},t)))})};const B=["All Users","Create Group","Settings","Logout"];var W=e=>{const{oldChat:s,recipientUser:t,loginInfo:n,chats:c,users:r}=e,[l,d]=Object(a.useState)(!1),[h,g]=Object(a.useState)(!1),[p,u]=Object(a.useState)(!1);Object(i.c)();Object(a.useEffect)((()=>{console.log("oldChat",s),console.log("recipientUser",t)}));const j=()=>{d(!1),u(!1),g(!1)};return Object(o.jsxs)("div",{className:"chat-left-container",children:[Object(o.jsxs)("div",{className:"chat-left-top",children:[Object(o.jsxs)("div",{className:"chat-left-user-profile",children:[n.data.avatarUrl?Object(o.jsx)("img",{src:n.data.avatarUrl,alt:"Avatar",className:"chat-user-profile-avatar"}):Object(o.jsx)("span",{className:"chat-user-icon"}),Object(o.jsx)("span",{className:n.data.avatarUrl?"chat-left-user-profile-user-name":"chat-left-user-profile-user-name2",children:n.data.firstName})]}),Object(o.jsxs)("div",{className:"chat-left-options",children:[Object(o.jsx)("i",{className:"chat-left-options-icon",onClick:()=>{d((e=>!e))},children:"..."}),l?Object(o.jsx)(V,{selectedItem:e=>{console.log(e),d(!1),"Create Group"===e?g(!0):"All Users"===e?u(!0):"Logout"===e&&window.location.reload()},dropDownList:B}):""]})]}),h?Object(o.jsx)(Y,{users:r,submitCreateGroup:s=>{console.log(s),g(!1),e.submitCreateGroup(s)},loginInfo:n,backFromCreateGroup:()=>{g(!1),u(!1),d(!1)}}):p?Object(o.jsx)("div",{children:Object(o.jsx)("div",{className:"chat-right",children:Object(o.jsx)(H,{startChat:s=>{console.log(s),e.startChat(s),j()},loginInfo:n,users:r,closeOpenOption:j})})}):Object(o.jsx)("div",{onClick:()=>{d(!1)},children:Object(o.jsx)(J,{loginInfo:n,chats:c,_chats:c,oldChat:s,recipientUser:t,openUserChat:(s,t)=>{e.openUserChat(s,t)},users:r})})]})},X=null;var q=e=>{const{loginInfo:s}=e,[n,c]=Object(a.useState)({}),[r,l]=Object(a.useState)({}),[d,g]=Object(a.useState)(""),j=Object(i.c)();Object(a.useLayoutEffect)((()=>{j(U())}),[j]),Object(a.useEffect)((()=>{j(x(s.data.id)),j(v(s.data.id))}),[j,s.data.id]),Object(a.useEffect)((()=>{null==X&&C()}));const m=Object(i.d)((e=>e.users));console.log("users",m);const S=Object(i.d)((e=>e.chats)),C=()=>{const e=t(63);var s=t(70);s=new s("http://localhost:3001"===window.location.origin?"http://localhost:2727/ws":window.location.origin+"/ws"),(X=e.over(s)).connect({},b,E)},b=()=>{console.log("connected"),X.subscribe("/user/"+s.data.id+"/queue/messages",_)},E=e=>{console.log(e)},_=e=>{const s=JSON.parse(e.body);var t;console.log("Message recevied",s),y.USER===s.messageType?j(p(s.message[0])):y.GROUP===s.messageType?j((t=s.message[0],{type:h.RECIVE_GROUP_CHAT_MSG_SUCCESS,response:t})):(y.CHAT_USER_TYPING===s.messageType||y.GROUP_CHAT_USER_TYPING===s.messageType)&&j(O(s.message))};return Object(o.jsx)("div",{className:"chat-container",children:Object(o.jsxs)("div",{className:"chat-row",children:[Object(o.jsx)("div",{className:"chat-left",children:Object(o.jsx)(W,{oldChat:r,recipientUser:n,loginInfo:s,chats:S,openUserChat:(e,t)=>{console.log(e);let a=null;if(y.USER===t){if(s.data.id===e.reciverUser.id?c({...e.senderUser}):c({...e.reciverUser}),S&&S.data){const t=S.data.findIndex((t=>t.senderUser&&(t.senderUser.id===s.data.id||t.senderUser.id===e.senderUser.id)&&t.reciverUser&&(t.reciverUser.id===e.reciverUser.id||t.reciverUser.id===s.data.id)));t>-1&&(a=S.data[t])}}else if(S&&S.data){const s=S.data.findIndex((s=>s.chatRoomId===e.chatRoomId));s>-1&&(a=S.data[s])}l({...a}),g(t)},users:m,submitCreateGroup:e=>{j(G(e))},startChat:e=>{console.log(e),c({...e});let t=null;if(S&&S.data){const a=S.data.findIndex((t=>(t.senderUserId===s.data.id||t.senderUserId===e.id)&&(t.reciverUserId===e.id||t.reciverUserId===s.data.id)));t=a>-1?S.data[a]:null,console.log(t)}l({...t}),g(y.USER)}})}),Object(o.jsx)("div",{className:"chat-middle",children:Object(o.jsx)(L,{oldChat:r,recipientUser:n,loginInfo:s,sendMessage:(e,s)=>{var t;s===y.USER?j((t=e,e=>fetch(f.SNED_MSG,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(t)}).then((e=>e.json())).then((s=>{console.log(s),s&&0===s.statusCode?e(p(s.result[0])):e(u(s.description))})).catch((s=>{console.log(s),e(u("Login failed"))})))):j(T(e)),console.log("Message sent successfully",JSON.stringify(e))},chats:(()=>{if(S&&S.data&&S.data.length){var e=-1;return(e=d===y.USER?S.data.findIndex((e=>e.chatId&&e.chatId===r.chatId||e.reciverUserId===n.id)):S.data.findIndex((e=>e.chatRoomId===r.chatRoomId)))>-1?S.data[e]:1===S.data.length&&(r.chatId||r.chatRoomId)?S.data[0]:null}return null})(),chatType:d,users:m,sendTypingNotification:e=>{j(function(e){return s=>fetch(f.SEND_TYPING_MESSAGE,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((e=>e.json())).then((e=>{console.log(e)})).catch((e=>{console.log(e)}))}(e))}})})]})})};t(98);class K extends n.a.Component{constructor(e){super(e),this.handleScroll=e=>{},this.state={isSignIn:!0},this.createAccount=this.createAccount.bind(this),this.signIn=this.signIn.bind(this),this.gotoLogin=this.gotoLogin.bind(this)}createAccount(e){console.log(e),this.props.signUp(e).then((()=>{console.log(this.props.signUpData),this.props.signUpData&&!this.props.signUpData.isError?setTimeout((()=>this.setState({isSignIn:!0})),2e3):this.setState({isSignIn:!1})}))}signIn(e){console.log(e),this.props.signIn(e)}gotoLogin(){this.setState({isSignIn:!0})}render(){return Object(o.jsxs)("div",{children:[console.log("m -loginInfo",this.props.loginInfo),this.props.loginInfo&&!this.props.loginInfo.isLogin?Object(o.jsx)("div",{className:"main-container",children:Object(o.jsxs)("div",{className:"main-login-container",children:[Object(o.jsx)("div",{className:"signin-signup-div",children:Object(o.jsx)("span",{children:"Welcome to Chat Application"})}),this.state.isSignIn?Object(o.jsxs)("div",{children:[Object(o.jsx)(l,{signIn:this.signIn,loginInfo:this.props.loginInfo}),Object(o.jsx)("button",{className:"btn-info c-cbtn-sign-up",onClick:e=>{this.setState({isSignIn:!1})},children:"Create Account!"})]}):Object(o.jsx)(d,{createAccount:this.createAccount,gotoLogin:this.gotoLogin})]})}):Object(o.jsx)(q,{loginInfo:this.props.loginInfo})]})}}var z=Object(i.b)((function(e){return{loginInfo:e.loginInfo,signUpData:e.signUp}}),(function(e){return{dispatch:e,signIn:s=>e(I(s)),signUp:s=>e(N(s))}}),null,{pure:!1})(K);class Q extends n.a.Component{render(){return Object(o.jsx)("div",{children:Object(o.jsx)(z,{})})}}var Z=Q,$=(t(99),t(15));function ee(e,s){if(e&&e.length){const t=e.findIndex((e=>e.chatId===s.chatId));return t>-1?e[t].chatMessages.push(s.chatMessages[0]):e.push(s),e}return[s]}function se(e,s){if(e&&e.length){const t=e.findIndex((e=>e.chatRoomId===s.chatRoomId));return t>-1?e[t].chatMessages.push(s.chatMessages[0]):e.push(s),e}return[s]}function te(e,s){return e&&e.length?e.concat(s):[s]}function ae(e,s){if(s.chatType===y.USER){const t=e.findIndex((e=>e.chatId===s.id));return t>-1&&(e[t]={...e[t],typing:{...s,isTyping:!0}}),e}{const t=e.findIndex((e=>e.chatRoomId===parseInt(s.id)));return t>-1&&(e[t]={...e[t],typing:{...s,isTyping:!0}}),e}}function ne(e,s){if(s.chatType===y.USER){const t=e.findIndex((e=>e.chatId===s.id));return t>-1&&(e[t]={...e[t],typing:{...s,isTyping:!1}}),e}{const t=e.findIndex((e=>e.chatRoomId===parseInt(s.id)));return t>-1&&(e[t]={...e[t],typing:{...s,isTyping:!1}}),e}}function ce(e){if(e&&e.length){for(var s=0;s<e.length;s++)e[s].chatMessages&&(e[s].chatMessages=e[s].chatMessages.sort(((e,s)=>new Date(s.messageTimestamp)-new Date(e.messageTimestamp))),e[s]={...e[s],lastTimestamp:e[s].chatMessages.length?e[s].chatMessages[0].messageTimestamp:e[s].createdTimestamp,lastMessage:e[s].chatMessages.length?e[s].chatMessages[0].message:"",lastMessageSentBy:e[s].chatMessages.length?e[s].chatMessages[0].senderUserId:""},e[s].chatMessages=e[s].chatMessages.sort(((e,s)=>new Date(e.messageTimestamp)-new Date(s.messageTimestamp))));e=e.sort(((e,s)=>new Date(s.lastTimestamp)-new Date(e.lastTimestamp)))}return e}const re=Object($.b)({loginInfo:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;switch(s.type){case h.LOGIN_LOADING:return{...e,isLogin:!1,data:null,loginType:null,message:null};case h.LOGIN_SUCCESS:return{...e,isLogin:!0,data:s.response,message:null};case h.LOGIN_FAILED:return{...e,isLogin:!1,data:s.response,message:s.response.description};default:return e}},users:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;switch(s.type){case h.FETCH_USERS_LOADING:return{...e,isLoading:!0,isError:!1,data:null};case h.FETCH_USERS_SUCCESS:return{...e,isLoading:!1,isError:!1,data:s.response};case h.FETCH_USERS_FAILED:return{...e,isLoading:!1,isError:!0,data:null,message:s.failedMessage};default:return e}},chatMessages:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;switch(s.type){case h.FETCH_CHAT_MSGS_LOADING:return{...e,isLoading:!0,isError:!1,data:null};case h.FETCH_CHAT_MSGS_SUCCESS:return{...e,isLoading:!1,isError:!1,data:s.response};case h.FETCH_CHAT_MSGS_FAILED:return{...e,isLoading:!1,isError:!0,data:null,message:s.failedMessage};default:return e}},chats:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;switch(s.type){case h.FETCH_CHATS_LOADING:return{...e,isLoading:!0,isError:!1,data:[]};case h.FETCH_CHATS_SUCCESS:return{...e,isLoading:!1,isError:!1,data:ce(s.response)};case h.FETCH_CHATS_FAILED:return{...e,isLoading:!1,isError:!0,data:[],message:s.failedMessage};case h.MSG_SEND_SUCCESS:return{...e,isLoading:!1,isError:!1,data:ce(ee(e.data,s.response))};case h.MSG_SEND_FAILED:return{...e,isLoading:!1,isError:!0,message:s.failedMessage};case h.GROUP_MSG_SEND_SUCCESS:return{...e,isLoading:!1,isError:!1,data:ce(se(e.data,s.response))};case h.GROUP_MSG_SEND_FAILED:return{...e,isLoading:!1,isError:!0,message:s.failedMessage};case h.FETCH_GROUP_CHATS_SUCCESS:return{...e,isLoading:!1,isError:!1,data:ce(te(e.data,s.response))};case h.FETCH_GROUP_CHATS_FAILED:return{...e,isLoading:!1,isError:!0,message:s.failedMessage};case h.CREATE_GROUP_SUCCESS:return{...e,isLoading:!1,isError:!1,data:ce(te(e.data,s.response))};case h.CREATE_GROUP_FAILED:return{...e,isLoading:!1,isError:!0,message:s.failedMessage};case h.RECIVE_GROUP_CHAT_MSG_SUCCESS:return{...e,isLoading:!1,isError:!1,data:ce(se(e.data,s.response))};case h.RECIVE_CHAT_MESSAGE_TYPING:return{...e,data:ae(e.data,s.response)};case h.CHAT_MESSAGE_TYPING_STOP:return{...e,data:ne(e.data,s.response)};default:return e}},signUp:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;switch(s.type){case h.SIGNUP_LOADING:return{...e,isLoading:!0,isError:!1,data:null,message:null,statusCode:null};case h.SIGNUP_SUCCESS:return{...e,isLoading:!1,isError:!1,data:s.response.result[0],message:s.response.description,statusCode:s.response.statusCode};case h.SIGNUP_FAILED:return{...e,isLoading:!1,isError:!0,data:null,message:s.response.description,statusCode:s.response.statusCode};default:return e}}});var ie=re,oe=t(43);t(100);const le=[oe.a];var de=Object($.c)(ie,{},Object($.a)(...le));r.a.render(Object(o.jsx)(i.a,{store:de,children:Object(o.jsx)(Z,{})}),document.getElementById("root"))},25:function(e,s,t){},48:function(e,s,t){},49:function(e,s,t){},54:function(e,s,t){},55:function(e,s,t){},56:function(e,s,t){},57:function(e,s,t){},58:function(e,s,t){},59:function(e,s,t){},60:function(e,s,t){},61:function(e,s,t){},62:function(e,s,t){},98:function(e,s,t){}},[[101,1,2]]]);
//# sourceMappingURL=main.1473e88a.chunk.js.map